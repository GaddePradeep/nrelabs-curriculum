# Test max MTU

This folder contains a docker-compose.yml file that launches one vQFX connected to two alpine based containers. Shell script check.sh waits for all PFEs to be up and reports the max MTU capable of passing thru.

```

```

## Topology

```
+---------------+     +-------------------------+     +---------------+
| alpine1a eth1 |-----| xe-0/0/0 vqfx1 xe-0/0/1 |-----| eth1 alpine1b |
| 192.168.99.1  |     |  irb.0 192.168.99.254   |     | 192.168.99.2  |
+---------------+     +-------------------------+     +---------------+
```

### vqfx1

```
mwiget@vqfx1> show vlans

Routing instance        VLAN name             Tag          Interfaces
default-switch          vlan100               100
                                                           xe-0/0/0.0*
                                                           xe-0/0/1.0*
{master:0}
mwiget@vqfx1> show interfaces terse irb.0
Interface               Admin Link Proto    Local                 Remote
irb.0                   up    up   inet     192.168.99.254/24

{master:0}
mwiget@vqfx1> show configuration interfaces irb
unit 0 {
    family inet {
        address 192.168.99.254/24;
    }
}

{master:0}
mwiget@vqfx1> show configuration vlans vlan100
vlan-id 100;
l3-interface irb.0;

{master:0}
mwiget@vqfx1> show arp
MAC Address       Address         Name                      Interface               Flags
e2:a7:89:27:34:65 169.254.0.1     169.254.0.1               em1.0                   none
02:42:0d:c9:53:50 172.25.0.1      172.25.0.1                em0.0                   none
96:b4:43:5e:0b:84 192.168.99.1    192.168.99.1              irb.0 [xe-0/0/0.0]      none
0e:ae:46:c0:ea:09 192.168.99.2    192.168.99.2              irb.0 [xe-0/0/1.0]      none
Total entries: 3
```

interfaces within the vQFX container:

```
root@vqfx1:/# ip link
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: em0@eth0: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 500
    link/ether 02:42:ac:19:00:04 brd ff:ff:ff:ff:ff:ff
3: vtapeth1@eth1: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 9000 qdisc fq_codel state UP mode DEFAULT group default qlen 500
    link/ether f2:d8:ff:da:93:d6 brd ff:ff:ff:ff:ff:ff
4: vtapeth2@eth2: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 9000 qdisc fq_codel state UP mode DEFAULT group default qlen 500
    link/ether 72:fe:e2:8e:a8:df brd ff:ff:ff:ff:ff:ff
5: em1: <BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP> mtu 9500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether e2:a7:89:27:34:65 brd ff:ff:ff:ff:ff:ff
6: em2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 42:cf:0f:64:92:8d brd ff:ff:ff:ff:ff:ff
198: eth0@if199: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default
    link/ether 02:42:ac:19:00:04 brd ff:ff:ff:ff:ff:ff link-netnsid 0
201: eth1@if200: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9000 qdisc noqueue state UP mode DEFAULT group default qlen 1000
    link/ether f2:d8:ff:da:93:d6 brd ff:ff:ff:ff:ff:ff link-netnsid 1
203: eth2@if202: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9000 qdisc noqueue state UP mode DEFAULT group default qlen 1000
    link/ether 72:fe:e2:8e:a8:df brd ff:ff:ff:ff:ff:ff link-netnsid 2
```



### alpine1a

```
$ docker exec -ti testmtu_alpine1a_1 ash
/ # ifconfig eth1
eth1      Link encap:Ethernet  HWaddr 96:B4:43:5E:0B:84
          inet addr:192.168.99.1  Bcast:192.168.99.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:9000  Metric:1
          RX packets:173 errors:0 dropped:0 overruns:0 frame:0
          TX packets:196 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:57917 (56.5 KiB)  TX bytes:79472 (77.6 KiB)

/ # ping 192.168.99.2 -c 3
PING 192.168.99.2 (192.168.99.2): 56 data bytes
64 bytes from 192.168.99.2: seq=0 ttl=64 time=101.977 ms
64 bytes from 192.168.99.2: seq=1 ttl=64 time=101.819 ms
64 bytes from 192.168.99.2: seq=2 ttl=64 time=101.684 ms

--- 192.168.99.2 ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 101.684/101.826/101.977 ms
/ # arp -na
? (192.168.99.2) at 0e:ae:46:c0:ea:09 [ether]  on eth1
? (172.25.0.1) at 02:42:0d:c9:53:50 [ether]  on eth0
? (192.168.99.254) at 02:05:86:71:25:00 [ether]  on eth1
/ #
```



To see where the oversized packets get. lost, I'll send one ICMP ping from 192.168.99.1 to 192.168.99.2 of size 1486 (passes) with a payload of all 0xaf, followed by a size 1487 (dropped) with a payload of all 0xfa and capture the communication between Junos and cosim:

```
$ docker exec -ti testmtu_alpine1a_1 ash

/ # ping 192.168.99.2 -p af -s 1486 -c 1
PING 192.168.99.2 (192.168.99.2): 1486 data bytes
1494 bytes from 192.168.99.2: seq=0 ttl=64 time=3.446 ms

--- 192.168.99.2 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.446/3.446/3.446 ms
/ # ping 192.168.99.2 -p fa -s 1487 -c 1
PING 192.168.99.2 (192.168.99.2): 1487 data bytes

--- 192.168.99.2 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
/ # ifconfig eth1
eth1      Link encap:Ethernet  HWaddr 96:B4:43:5E:0B:84
          inet addr:192.168.99.1  Bcast:192.168.99.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:9000  Metric:1
          RX packets:142 errors:0 dropped:0 overruns:0 frame:0
          TX packets:162 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:45450 (44.3 KiB)  TX bytes:63025 (61.5 KiB)

/ # arp -na
? (192.168.99.2) at 0e:ae:46:c0:ea:09 [ether]  on eth1
? (172.25.0.1) at 02:42:0d:c9:53:50 [ether]  on eth0
/ #
```

Cosim communication traffic is capture via tcpdump in the vQFX container on interface em1:

```
$ docker exec -ti testmtu_vqfx1_1 bash

root@vqfx1:/# ifconfig em1
em1: flags=4419<UP,BROADCAST,RUNNING,PROMISC,MULTICAST>  mtu 9500
        inet 169.254.0.1  netmask 255.255.255.0  broadcast 0.0.0.0
        ether e2:a7:89:27:34:65  txqueuelen 1000  (Ethernet)
        RX packets 880606  bytes 92029301 (92.0 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 563631  bytes 40636078 (40.6 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

root@vqfx1:/# tcpdump -n -i em1 -s 2000 -w /em1.pcap
tcpdump: listening on em1, link-type EN10MB (Ethernet), capture size 2000 bytes
^C1161 packets captured
1165 packets received by filter
0 packets dropped by kernel

```

The captured raw data is found in [em1.pcap](em1.pcap) and the extracted TCP payload in [em1payload_stream2.txt](em1payload_stream2.txt) of stream 2 from cosim 169.254.0.1 to junos 169.254.0.2:

The smaller packet can be seen twice, from alpine1a (96:b4:43:5e:0b:84) to alpine2a (0e:ae:46:c0:ea:09):

```
000004A8  00 0a 00 00 00 00 06 0c  00 00 00 00 00 00 00 01   ........ ........
000004B8  00 00 00 00 00 00 00 00  00 00 05 f8 0e ae 46 c0   ........ ......F.
000004C8  ea 09 96 b4 43 5e 0b 84  08 00 45 00 05 ea 1c 5f   ....C^.. ..E...._
000004D8  40 00 40 01 d1 5f c0 a8  63 01 c0 a8 63 02 08 af   @.@.._.. c...c...
000004E8  fa 87 38 00 00 00 26 6b  16 d6 af af af af af af   ..8...&k ........
000004F8  af af af af af af af af  af af af af af af af af   ........ ........
00000508  af af af af af af af af  af af af af af af af af   ........ ........
00000518  af af af af af af af af  af af af af af af af af   ........ ........
00000528  af af af af af af af af  af af af af af af af af   ........ ........
00000538  af af af af af af af af  af af af af af af af af   ........ ........
00000548  af af af af af af af af  af af af af af af af af   ........ ........
00000558  af af af af af af af af  af af af af af af af af   ........ ........
00000568  af af af af af af af af  af af af af af af af af   ........ ........
00000578  af af af af af af af af  af af af af af af af af   ........ ........
00000588  af af af af af af af af  af af af af af af af af   ........ ........
00000598  af af af af af af af af  af af af af af af af af   ........ ........
000005A8  af af af af af af af af  af af af af af af af af   ........ ........
000005B8  af af af af af af af af  af af af af af af af af   ........ ........
000005C8  af af af af af af af af  af af af af af af af af   ........ ........
000005D8  af af af af af af af af  af af af af af af af af   ........ ........
000005E8  af af af af af af af af  af af af af af af af af   ........ ........
000005F8  af af af af af af af af  af af af af af af af af   ........ ........
00000608  af af af af af af af af  af af af af af af af af   ........ ........
00000618  af af af af af af af af  af af af af af af af af   ........ ........
00000628  af af af af af af af af  af af af af af af af af   ........ ........
00000638  af af af af af af af af  af af af af af af af af   ........ ........
00000648  af af af af af af af af  af af af af af af af af   ........ ........
00000658  af af af af af af af af  af af af af af af af af   ........ ........
00000668  af af af af af af af af  af af af af af af af af   ........ ........
00000658  af af af af af af af af  af af af af af af af af   ........ ........
00000668  af af af af af af af af  af af af af af af af af   ........ ........
00000678  af af af af af af af af  af af af af af af af af   ........ ........
00000688  af af af af af af af af  af af af af af af af af   ........ ........
00000698  af af af af af af af af  af af af af af af af af   ........ ........
000006A8  af af af af af af af af  af af af af af af af af   ........ ........
000006B8  af af af af af af af af  af af af af af af af af   ........ ........
000006C8  af af af af af af af af  af af af af af af af af   ........ ........
000006D8  af af af af af af af af  af af af af af af af af   ........ ........
000006E8  af af af af af af af af  af af af af af af af af   ........ ........
000006F8  af af af af af af af af  af af af af af af af af   ........ ........
00000708  af af af af af af af af  af af af af af af af af   ........ ........
00000718  af af af af af af af af  af af af af af af af af   ........ ........
00000728  af af af af af af af af  af af af af af af af af   ........ ........
00000738  af af af af af af af af  af af af af af af af af   ........ ........
00000748  af af af af af af af af  af af af af af af af af   ........ ........
00000758  af af af af af af af af  af af af af af af af af   ........ ........
00000768  af af af af af af af af  af af af af af af af af   ........ ........
00000778  af af af af af af af af  af af af af af af af af   ........ ........
00000788  af af af af af af af af  af af af af af af af af   ........ ........
00000798  af af af af af af af af  af af af af af af af af   ........ ........
000007A8  af af af af af af af af  af af af af af af af af   ........ ........
000007B8  af af af af af af af af  af af af af af af af af   ........ ........
000007C8  af af af af af af af af  af af af af af af af af   ........ ........
000007D8  af af af af af af af af  af af af af af af af af   ........ ........
000007E8  af af af af af af af af  af af af af af af af af   ........ ........
000007F8  af af af af af af af af  af af af af af af af af   ........ ........
00000808  af af af af af af af af  af af af af af af af af   ........ ........
00000818  af af af af af af af af  af af af af af af af af   ........ ........
00000828  af af af af af af af af  af af af af af af af af   ........ ........
00000838  af af af af af af af af  af af af af af af af af   ........ ........
00000848  af af af af af af af af  af af af af af af af af   ........ ........
00000858  af af af af af af af af  af af af af af af af af   ........ ........
00000868  af af af af af af af af  af af af af af af af af   ........ ........
00000878  af af af af af af af af  af af af af af af af af   ........ ........
00000888  af af af af af af af af  af af af af af af af af   ........ ........
00000898  af af af af af af af af  af af af af af af af af   ........ ........
000008A8  af af af af af af af af  af af af af af af af af   ........ ........
000008B8  af af af af af af af af  af af af af af af af af   ........ ........
000008C8  af af af af af af af af  af af af af af af af af   ........ ........
000008D8  af af af af af af af af  af af af af af af af af   ........ ........
000008E8  af af af af af af af af  af af af af af af af af   ........ ........
000008F8  af af af af af af af af  af af af af af af af af   ........ ........
00000908  af af af af af af af af  af af af af af af af af   ........ ........
00000918  af af af af af af af af  af af af af af af af af   ........ ........
00000928  af af af af af af af af  af af af af af af af af   ........ ........
00000938  af af af af af af af af  af af af af af af af af   ........ ........
00000948  af af af af af af af af  af af af af af af af af   ........ ........
00000938  af af af af af af af af  af af af af af af af af   ........ ........
00000948  af af af af af af af af  af af af af af af af af   ........ ........
00000958  af af af af af af af af  af af af af af af af af   ........ ........
00000968  af af af af af af af af  af af af af af af af af   ........ ........
00000978  af af af af af af af af  af af af af af af af af   ........ ........
00000988  af af af af af af af af  af af af af af af af af   ........ ........
00000998  af af af af af af af af  af af af af af af af af   ........ ........
000009A8  af af af af af af af af  af af af af af af af af   ........ ........
000009B8  af af af af af af af af  af af af af af af af af   ........ ........
000009C8  af af af af af af af af  af af af af af af af af   ........ ........
000009D8  af af af af af af af af  af af af af af af af af   ........ ........
000009E8  af af af af af af af af  af af af af af af af af   ........ ........
000009F8  af af af af af af af af  af af af af af af af af   ........ ........
00000A08  af af af af af af af af  af af af af af af af af   ........ ........
00000A18  af af af af af af af af  af af af af af af af af   ........ ........
00000A28  af af af af af af af af  af af af af af af af af   ........ ........
00000A38  af af af af af af af af  af af af af af af af af   ........ ........
00000A48  af af af af af af af af                            ........
00000A50  af af af af af af af af  af af af af af af af af   ........ ........
00000A60  af af af af af af af af  af af af af af af af af   ........ ........
00000A70  af af af af af af af af  af af af af af af af af   ........ ........
00000A80  af af af af af af af af  af af af af af af af af   ........ ........
00000A90  af af af af af af af af  af af af af af af af af   ........ ........
00000AA0  af af af af af af af af  af af af af af af af af   ........ ........
00000AB0  af af af af af af af af  af af af af               ........ ....
```

and the reply:

```
00000ABC  00 0a 00 00 00 00 06 0c  00 00 00 00 00 00 00 00   ........ ........
00000ACC  00 00 00 00 00 00 00 00  00 00 05 f8 96 b4 43 5e   ........ ......C^
00000ADC  0b 84 0e ae 46 c0 ea 09  08 00 45 00 05 ea 0e 89   ....F... ..E.....
00000AEC  00 00 40 01 1f 36 c0 a8  63 02 c0 a8 63 01 00 af   ..@..6.. c...c...
00000AFC  02 88 38 00 00 00 26 6b  16 d6 af af af af af af   ..8...&k ........
00000B0C  af af af af af af af af  af af af af af af af af   ........ ........
00000B1C  af af af af af af af af  af af af af af af af af   ........ ........
00000B2C  af af af af af af af af  af af af af af af af af   ........ ........
00000B3C  af af af af af af af af  af af af af af af af af   ........ ........
00000B4C  af af af af af af af af  af af af af af af af af   ........ ........
00000B5C  af af af af af af af af  af af af af af af af af   ........ ........
00000B6C  af af af af af af af af  af af af af af af af af   ........ ........
00000B7C  af af af af af af af af  af af af af af af af af   ........ ........
00000B8C  af af af af af af af af  af af af af af af af af   ........ ........
00000B9C  af af af af af af af af  af af af af af af af af   ........ ........
00000BAC  af af af af af af af af  af af af af af af af af   ........ ........
00000BBC  af af af af af af af af  af af af af af af af af   ........ ........
00000BCC  af af af af af af af af  af af af af af af af af   ........ ........
00000BDC  af af af af af af af af  af af af af af af af af   ........ ........
00000BEC  af af af af af af af af  af af af af af af af af   ........ ........
00000BFC  af af af af af af af af  af af af af af af af af   ........ ........
00000C0C  af af af af af af af af  af af af af af af af af   ........ ........
00000C1C  af af af af af af af af  af af af af af af af af   ........ ........
00000C0C  af af af af af af af af  af af af af af af af af   ........ ........
00000C1C  af af af af af af af af  af af af af af af af af   ........ ........
00000C2C  af af af af af af af af  af af af af af af af af   ........ ........
00000C3C  af af af af af af af af  af af af af af af af af   ........ ........
00000C4C  af af af af af af af af  af af af af af af af af   ........ ........
00000C5C  af af af af af af af af  af af af af af af af af   ........ ........
00000C6C  af af af af af af af af  af af af af af af af af   ........ ........
00000C7C  af af af af af af af af  af af af af af af af af   ........ ........
00000C8C  af af af af af af af af  af af af af af af af af   ........ ........
00000C9C  af af af af af af af af  af af af af af af af af   ........ ........
00000CAC  af af af af af af af af  af af af af af af af af   ........ ........
00000CBC  af af af af af af af af  af af af af af af af af   ........ ........
00000CCC  af af af af af af af af  af af af af af af af af   ........ ........
00000CDC  af af af af af af af af  af af af af af af af af   ........ ........
00000CEC  af af af af af af af af  af af af af af af af af   ........ ........
00000CFC  af af af af af af af af  af af af af af af af af   ........ ........
00000D0C  af af af af af af af af  af af af af af af af af   ........ ........
00000D1C  af af af af af af af af  af af af af af af af af   ........ ........
00000D2C  af af af af af af af af  af af af af af af af af   ........ ........
00000D3C  af af af af af af af af  af af af af af af af af   ........ ........
00000D4C  af af af af af af af af  af af af af af af af af   ........ ........
00000D5C  af af af af af af af af  af af af af af af af af   ........ ........
00000D6C  af af af af af af af af  af af af af af af af af   ........ ........
00000D7C  af af af af af af af af  af af af af af af af af   ........ ........
00000D8C  af af af af af af af af  af af af af af af af af   ........ ........
00000D9C  af af af af af af af af  af af af af af af af af   ........ ........
00000DAC  af af af af af af af af  af af af af af af af af   ........ ........
00000DBC  af af af af af af af af  af af af af af af af af   ........ ........
00000DCC  af af af af af af af af  af af af af af af af af   ........ ........
00000DDC  af af af af af af af af  af af af af af af af af   ........ ........
00000DEC  af af af af af af af af  af af af af af af af af   ........ ........
00000DFC  af af af af af af af af  af af af af af af af af   ........ ........
00000E0C  af af af af af af af af  af af af af af af af af   ........ ........
00000E1C  af af af af af af af af  af af af af af af af af   ........ ........
00000E2C  af af af af af af af af  af af af af af af af af   ........ ........
00000E3C  af af af af af af af af  af af af af af af af af   ........ ........
00000E4C  af af af af af af af af  af af af af af af af af   ........ ........
00000E5C  af af af af af af af af  af af af af af af af af   ........ ........
00000E6C  af af af af af af af af  af af af af af af af af   ........ ........
00000E7C  af af af af af af af af  af af af af af af af af   ........ ........
00000E8C  af af af af af af af af  af af af af af af af af   ........ ........
00000E9C  af af af af af af af af  af af af af af af af af   ........ ........
00000EAC  af af af af af af af af  af af af af af af af af   ........ ........
00000EBC  af af af af af af af af  af af af af af af af af   ........ ........
00000ECC  af af af af af af af af  af af af af af af af af   ........ ........
00000EDC  af af af af af af af af  af af af af af af af af   ........ ........
00000EEC  af af af af af af af af  af af af af af af af af   ........ ........
00000EFC  af af af af af af af af  af af af af af af af af   ........ ........
00000EEC  af af af af af af af af  af af af af af af af af   ........ ........
00000EFC  af af af af af af af af  af af af af af af af af   ........ ........
00000F0C  af af af af af af af af  af af af af af af af af   ........ ........
00000F1C  af af af af af af af af  af af af af af af af af   ........ ........
00000F2C  af af af af af af af af  af af af af af af af af   ........ ........
00000F3C  af af af af af af af af  af af af af af af af af   ........ ........
00000F4C  af af af af af af af af  af af af af af af af af   ........ ........
00000F5C  af af af af af af af af  af af af af af af af af   ........ ........
00000F6C  af af af af af af af af  af af af af af af af af   ........ ........
00000F7C  af af af af af af af af  af af af af af af af af   ........ ........
00000F8C  af af af af af af af af  af af af af af af af af   ........ ........
00000F9C  af af af af af af af af  af af af af af af af af   ........ ........
00000FAC  af af af af af af af af  af af af af af af af af   ........ ........
00000FBC  af af af af af af af af  af af af af af af af af   ........ ........
00000FCC  af af af af af af af af  af af af af af af af af   ........ ........
00000FDC  af af af af af af af af  af af af af af af af af   ........ ........
00000FEC  af af af af af af af af  af af af af af af af af   ........ ........
00000FFC  af af af af af af af af  af af af af af af af af   ........ ........
0000100C  af af af af af af af af  af af af af af af af af   ........ ........
0000101C  af af af af af af af af  af af af af af af af af   ........ ........
0000102C  af af af af af af af af  af af af af af af af af   ........ ........
0000103C  af af af af af af af af  af af af af af af af af   ........ ........
0000104C  af af af af af af af af  af af af af af af af af   ........ ........
0000105C  af af af af af af af af                            ........
00001064  af af af af af af af af  af af af af af af af af   ........ ........
00001074  af af af af af af af af  af af af af af af af af   ........ ........
00001084  af af af af af af af af  af af af af af af af af   ........ ........
00001094  af af af af af af af af  af af af af af af af af   ........ ........
000010A4  af af af af af af af af  af af af af af af af af   ........ ........
000010B4  af af af af af af af af  af af af af af af af af   ........ ........
000010C4  af af af af af af af af  af af af af               ........ ....
```



Now the one byte larger ICMP packet (payload 0xfa):

```
00001500  00 0a 00 00 00 00 06 10  00 00 00 00 00 00 00 01   ........ ........
00001510  00 00 00 00 00 00 00 00  00 00 05 f9 0e ae 46 c0   ........ ......F.
00001520  ea 09 96 b4 43 5e 0b 84  08 00 45 00 05 eb 1d dd   ....C^.. ..E.....
00001530  40 00 40 01 cf e0 c0 a8  63 01 c0 a8 63 02 08 fa   @.@..... c...c...
00001540  de ef 39 00 00 00 e2 c5  89 d6 fa fa fa fa fa fa   ..9..... ........
00001550  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001560  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001570  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001580  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001590  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000015A0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000015B0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000015C0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000015D0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000015E0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000015F0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001600  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001610  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001620  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001630  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001640  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001650  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001660  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001670  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001680  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001690  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016A0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016B0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016C0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016D0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016E0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016F0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001700  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001710  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001720  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001730  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001740  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001750  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001760  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001770  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001760  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001770  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001780  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001790  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017A0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017B0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017C0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017D0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017E0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017F0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001800  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001810  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001820  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001830  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001840  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001850  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001860  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001870  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001880  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001890  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018A0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018B0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018C0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018D0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018E0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018F0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001900  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001910  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001920  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001930  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001940  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001950  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001960  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001970  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001980  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001990  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019A0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019B0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019C0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019D0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019E0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019F0  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A00  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A10  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A20  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A30  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A40  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A50  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A40  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A50  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A60  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A70  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A80  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A90  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AA0  fa fa fa fa fa fa fa fa                            ........
00001AA8  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AB8  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AC8  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AD8  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AE8  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AF8  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B08  fa fa fa fa fa fa fa fa  fa fa fa fa fa 00 00 00   ........ ........
```

With the correct length, but no return packet can be found.

Now looking at stream 1, from Junos 169.254.0.2 to cosim 169.254.0.1, TCP payload captured in [em1payload_stream1.txt]().

First packet of size 1486, payload 0xaf:

```
0000057C  00 08 00 00 00 00 06 0c  00 00 00 00 00 00 00 00   ........ ........
0000058C  00 00 00 00 00 00 00 00  00 00 05 f8 0e ae 46 c0   ........ ......F.
0000059C  ea 09 96 b4 43 5e 0b 84  08 00 45 00 05 ea 1c 5f   ....C^.. ..E...._
000005AC  40 00 40 01 d1 5f c0 a8  63 01 c0 a8 63 02 08 af   @.@.._.. c...c...
000005BC  fa 87 38 00 00 00 26 6b  16 d6 af af af af af af   ..8...&k ........
0000059C  ea 09 96 b4 43 5e 0b 84  08 00 45 00 05 ea 1c 5f   ....C^.. ..E...._
000005AC  40 00 40 01 d1 5f c0 a8  63 01 c0 a8 63 02 08 af   @.@.._.. c...c...
000005BC  fa 87 38 00 00 00 26 6b  16 d6 af af af af af af   ..8...&k ........
000005CC  af af af af af af af af  af af af af af af af af   ........ ........
000005DC  af af af af af af af af  af af af af af af af af   ........ ........
000005EC  af af af af af af af af  af af af af af af af af   ........ ........
000005FC  af af af af af af af af  af af af af af af af af   ........ ........
0000060C  af af af af af af af af  af af af af af af af af   ........ ........
0000061C  af af af af af af af af  af af af af af af af af   ........ ........
0000062C  af af af af af af af af  af af af af af af af af   ........ ........
0000063C  af af af af af af af af  af af af af af af af af   ........ ........
0000064C  af af af af af af af af  af af af af af af af af   ........ ........
0000065C  af af af af af af af af  af af af af af af af af   ........ ........
0000066C  af af af af af af af af  af af af af af af af af   ........ ........
0000067C  af af af af af af af af  af af af af af af af af   ........ ........
0000068C  af af af af af af af af  af af af af af af af af   ........ ........
0000069C  af af af af af af af af  af af af af af af af af   ........ ........
000006AC  af af af af af af af af  af af af af af af af af   ........ ........
000006BC  af af af af af af af af  af af af af af af af af   ........ ........
000006CC  af af af af af af af af  af af af af af af af af   ........ ........
000006DC  af af af af af af af af  af af af af af af af af   ........ ........
000006EC  af af af af af af af af  af af af af af af af af   ........ ........
000006FC  af af af af af af af af  af af af af af af af af   ........ ........
0000070C  af af af af af af af af  af af af af af af af af   ........ ........
0000071C  af af af af af af af af  af af af af af af af af   ........ ........
0000072C  af af af af af af af af  af af af af af af af af   ........ ........
0000073C  af af af af af af af af  af af af af af af af af   ........ ........
0000074C  af af af af af af af af  af af af af af af af af   ........ ........
0000075C  af af af af af af af af  af af af af af af af af   ........ ........
0000076C  af af af af af af af af  af af af af af af af af   ........ ........
0000077C  af af af af af af af af  af af af af af af af af   ........ ........
0000078C  af af af af af af af af  af af af af af af af af   ........ ........
0000079C  af af af af af af af af  af af af af af af af af   ........ ........
000007AC  af af af af af af af af  af af af af af af af af   ........ ........
000007BC  af af af af af af af af  af af af af af af af af   ........ ........
000007CC  af af af af af af af af  af af af af af af af af   ........ ........
000007DC  af af af af af af af af  af af af af af af af af   ........ ........
000007EC  af af af af af af af af  af af af af af af af af   ........ ........
000007FC  af af af af af af af af  af af af af af af af af   ........ ........
0000080C  af af af af af af af af  af af af af af af af af   ........ ........
0000081C  af af af af af af af af  af af af af af af af af   ........ ........
0000082C  af af af af af af af af  af af af af af af af af   ........ ........
0000083C  af af af af af af af af  af af af af af af af af   ........ ........
0000084C  af af af af af af af af  af af af af af af af af   ........ ........
0000085C  af af af af af af af af  af af af af af af af af   ........ ........
0000086C  af af af af af af af af  af af af af af af af af   ........ ........
0000087C  af af af af af af af af  af af af af af af af af   ........ ........
0000088C  af af af af af af af af  af af af af af af af af   ........ ........
0000087C  af af af af af af af af  af af af af af af af af   ........ ........
0000088C  af af af af af af af af  af af af af af af af af   ........ ........
0000089C  af af af af af af af af  af af af af af af af af   ........ ........
000008AC  af af af af af af af af  af af af af af af af af   ........ ........
000008BC  af af af af af af af af  af af af af af af af af   ........ ........
000008CC  af af af af af af af af  af af af af af af af af   ........ ........
000008DC  af af af af af af af af  af af af af af af af af   ........ ........
000008EC  af af af af af af af af  af af af af af af af af   ........ ........
000008FC  af af af af af af af af  af af af af af af af af   ........ ........
0000090C  af af af af af af af af  af af af af af af af af   ........ ........
0000091C  af af af af af af af af  af af af af af af af af   ........ ........
0000092C  af af af af af af af af  af af af af af af af af   ........ ........
0000093C  af af af af af af af af  af af af af af af af af   ........ ........
0000094C  af af af af af af af af  af af af af af af af af   ........ ........
0000095C  af af af af af af af af  af af af af af af af af   ........ ........
0000096C  af af af af af af af af  af af af af af af af af   ........ ........
0000097C  af af af af af af af af  af af af af af af af af   ........ ........
0000098C  af af af af af af af af  af af af af af af af af   ........ ........
0000099C  af af af af af af af af  af af af af af af af af   ........ ........
000009AC  af af af af af af af af  af af af af af af af af   ........ ........
000009BC  af af af af af af af af  af af af af af af af af   ........ ........
000009CC  af af af af af af af af  af af af af af af af af   ........ ........
000009DC  af af af af af af af af  af af af af af af af af   ........ ........
000009EC  af af af af af af af af  af af af af af af af af   ........ ........
000009FC  af af af af af af af af  af af af af af af af af   ........ ........
00000A0C  af af af af af af af af  af af af af af af af af   ........ ........
00000A1C  af af af af af af af af  af af af af af af af af   ........ ........
00000A2C  af af af af af af af af  af af af af af af af af   ........ ........
00000A3C  af af af af af af af af  af af af af af af af af   ........ ........
00000A4C  af af af af af af af af  af af af af af af af af   ........ ........
00000A5C  af af af af af af af af  af af af af af af af af   ........ ........
00000A6C  af af af af af af af af  af af af af af af af af   ........ ........
00000A7C  af af af af af af af af  af af af af af af af af   ........ ........
00000A8C  af af af af af af af af  af af af af af af af af   ........ ........
00000A9C  af af af af af af af af  af af af af af af af af   ........ ........
00000AAC  af af af af af af af af  af af af af af af af af   ........ ........
00000ABC  af af af af af af af af  af af af af af af af af   ........ ........
00000ACC  af af af af af af af af  af af af af af af af af   ........ ........
00000ADC  af af af af af af af af  af af af af af af af af   ........ ........
00000AEC  af af af af af af af af  af af af af af af af af   ........ ........
00000AFC  af af af af af af af af  af af af af af af af af   ........ ........
00000B0C  af af af af af af af af  af af af af af af af af   ........ ........
00000B1C  af af af af af af af af                            ........
00000B24  af af af af af af af af  af af af af af af af af   ........ ........
00000B34  af af af af af af af af  af af af af af af af af   ........ ........
00000B44  af af af af af af af af  af af af af af af af af   ........ ........
00000B54  af af af af af af af af  af af af af af af af af   ........ ........
00000B64  af af af af af af af af  af af af af af af af af   ........ ........
00000B54  af af af af af af af af  af af af af af af af af   ........ ........
00000B64  af af af af af af af af  af af af af af af af af   ........ ........
00000B74  af af af af af af af af  af af af af af af af af   ........ ........
00000B84  af af af af af af af af  af af af af               ........ ....
```

and the response:

```
00000B90  00 08 00 00 00 00 06 0c  00 00 00 00 00 00 00 01   ........ ........
00000BA0  00 00 00 00 00 00 00 00  00 00 05 f8 96 b4 43 5e   ........ ......C^
00000BB0  0b 84 0e ae 46 c0 ea 09  08 00 45 00 05 ea 0e 89   ....F... ..E.....
00000BC0  00 00 40 01 1f 36 c0 a8  63 02 c0 a8 63 01 00 af   ..@..6.. c...c...
00000BD0  02 88 38 00 00 00 26 6b  16 d6 af af af af af af   ..8...&k ........
00000BE0  af af af af af af af af  af af af af af af af af   ........ ........
00000BF0  af af af af af af af af  af af af af af af af af   ........ ........
00000C00  af af af af af af af af  af af af af af af af af   ........ ........
00000C10  af af af af af af af af  af af af af af af af af   ........ ........
00000C20  af af af af af af af af  af af af af af af af af   ........ ........
00000C30  af af af af af af af af  af af af af af af af af   ........ ........
00000C40  af af af af af af af af  af af af af af af af af   ........ ........
00000C50  af af af af af af af af  af af af af af af af af   ........ ........
00000C60  af af af af af af af af  af af af af af af af af   ........ ........
00000C70  af af af af af af af af  af af af af af af af af   ........ ........
00000C80  af af af af af af af af  af af af af af af af af   ........ ........
00000C90  af af af af af af af af  af af af af af af af af   ........ ........
00000CA0  af af af af af af af af  af af af af af af af af   ........ ........
00000CB0  af af af af af af af af  af af af af af af af af   ........ ........
00000CC0  af af af af af af af af  af af af af af af af af   ........ ........
00000CD0  af af af af af af af af  af af af af af af af af   ........ ........
00000CE0  af af af af af af af af  af af af af af af af af   ........ ........
00000CF0  af af af af af af af af  af af af af af af af af   ........ ........
00000D00  af af af af af af af af  af af af af af af af af   ........ ........
00000D10  af af af af af af af af  af af af af af af af af   ........ ........
00000D20  af af af af af af af af  af af af af af af af af   ........ ........
00000D30  af af af af af af af af  af af af af af af af af   ........ ........
00000D40  af af af af af af af af  af af af af af af af af   ........ ........
00000D50  af af af af af af af af  af af af af af af af af   ........ ........
00000D60  af af af af af af af af  af af af af af af af af   ........ ........
00000D70  af af af af af af af af  af af af af af af af af   ........ ........
00000D80  af af af af af af af af  af af af af af af af af   ........ ........
00000D90  af af af af af af af af  af af af af af af af af   ........ ........
00000DA0  af af af af af af af af  af af af af af af af af   ........ ........
00000DB0  af af af af af af af af  af af af af af af af af   ........ ........
00000DC0  af af af af af af af af  af af af af af af af af   ........ ........
00000DD0  af af af af af af af af  af af af af af af af af   ........ ........
00000DE0  af af af af af af af af  af af af af af af af af   ........ ........
00000DF0  af af af af af af af af  af af af af af af af af   ........ ........
00000E00  af af af af af af af af  af af af af af af af af   ........ ........
00000E10  af af af af af af af af  af af af af af af af af   ........ ........
00000E20  af af af af af af af af  af af af af af af af af   ........ ........
00000E30  af af af af af af af af  af af af af af af af af   ........ ........
00000E40  af af af af af af af af  af af af af af af af af   ........ ........
00000E30  af af af af af af af af  af af af af af af af af   ........ ........
00000E40  af af af af af af af af  af af af af af af af af   ........ ........
00000E50  af af af af af af af af  af af af af af af af af   ........ ........
00000E60  af af af af af af af af  af af af af af af af af   ........ ........
00000E70  af af af af af af af af  af af af af af af af af   ........ ........
00000E80  af af af af af af af af  af af af af af af af af   ........ ........
00000E90  af af af af af af af af  af af af af af af af af   ........ ........
00000EA0  af af af af af af af af  af af af af af af af af   ........ ........
00000EB0  af af af af af af af af  af af af af af af af af   ........ ........
00000EC0  af af af af af af af af  af af af af af af af af   ........ ........
00000ED0  af af af af af af af af  af af af af af af af af   ........ ........
00000EE0  af af af af af af af af  af af af af af af af af   ........ ........
00000EF0  af af af af af af af af  af af af af af af af af   ........ ........
00000F00  af af af af af af af af  af af af af af af af af   ........ ........
00000F10  af af af af af af af af  af af af af af af af af   ........ ........
00000F20  af af af af af af af af  af af af af af af af af   ........ ........
00000F30  af af af af af af af af  af af af af af af af af   ........ ........
00000F40  af af af af af af af af  af af af af af af af af   ........ ........
00000F50  af af af af af af af af  af af af af af af af af   ........ ........
00000F60  af af af af af af af af  af af af af af af af af   ........ ........
00000F70  af af af af af af af af  af af af af af af af af   ........ ........
00000F80  af af af af af af af af  af af af af af af af af   ........ ........
00000F90  af af af af af af af af  af af af af af af af af   ........ ........
00000FA0  af af af af af af af af  af af af af af af af af   ........ ........
00000FB0  af af af af af af af af  af af af af af af af af   ........ ........
00000FC0  af af af af af af af af  af af af af af af af af   ........ ........
00000FD0  af af af af af af af af  af af af af af af af af   ........ ........
00000FE0  af af af af af af af af  af af af af af af af af   ........ ........
00000FF0  af af af af af af af af  af af af af af af af af   ........ ........
00001000  af af af af af af af af  af af af af af af af af   ........ ........
00001010  af af af af af af af af  af af af af af af af af   ........ ........
00001020  af af af af af af af af  af af af af af af af af   ........ ........
00001030  af af af af af af af af  af af af af af af af af   ........ ........
00001040  af af af af af af af af  af af af af af af af af   ........ ........
00001050  af af af af af af af af  af af af af af af af af   ........ ........
00001060  af af af af af af af af  af af af af af af af af   ........ ........
00001070  af af af af af af af af  af af af af af af af af   ........ ........
00001080  af af af af af af af af  af af af af af af af af   ........ ........
00001090  af af af af af af af af  af af af af af af af af   ........ ........
000010A0  af af af af af af af af  af af af af af af af af   ........ ........
000010B0  af af af af af af af af  af af af af af af af af   ........ ........
000010C0  af af af af af af af af  af af af af af af af af   ........ ........
000010D0  af af af af af af af af  af af af af af af af af   ........ ........
000010E0  af af af af af af af af  af af af af af af af af   ........ ........
000010F0  af af af af af af af af  af af af af af af af af   ........ ........
00001100  af af af af af af af af  af af af af af af af af   ........ ........
00001110  af af af af af af af af  af af af af af af af af   ........ ........
00001120  af af af af af af af af  af af af af af af af af   ........ ........
00000B54  af af af af af af af af  af af af af af af af af   ........ ........
00000B64  af af af af af af af af  af af af af af af af af   ........ ........
00000B74  af af af af af af af af  af af af af af af af af   ........ ........
00000B84  af af af af af af af af  af af af af
```



Now the oversized packet with payload 0xfa:

```
00001669  00 08 00 00 00 00 06 0d  00 00 00 00 00 00 00 00   ........ ........
00001679  00 00 00 00 00 00 00 00  00 00 05 f9 0e ae 46 c0   ........ ......F.
00001689  ea 09 96 b4 43 5e 0b 84  08 00 45 00 05 eb 1d dd   ....C^.. ..E.....
00001699  40 00 40 01 cf e0 c0 a8  63 01 c0 a8 63 02 08 fa   @.@..... c...c...
000016A9  de ef 39 00 00 00 e2 c5  89 d6 fa fa fa fa fa fa   ..9..... ........
000016B9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016C9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016D9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016E9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000016F9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001709  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001719  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001729  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001739  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001749  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001759  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001769  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001779  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001789  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001799  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017A9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017B9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017C9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017D9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017E9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000017F9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001809  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001819  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001829  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001839  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001849  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001859  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001869  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001879  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001889  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001899  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018A9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018B9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018C9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018D9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018E9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000018F9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001909  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001919  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001929  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001939  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001949  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001959  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001969  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001979  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001989  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001999  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019A9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019B9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019C9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019D9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019E9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
000019F9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A09  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A19  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A29  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A39  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A49  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A59  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A69  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A79  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A89  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001A99  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AA9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AB9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AC9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AD9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AE9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001AF9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B09  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B19  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B29  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B39  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B49  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B59  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B69  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B79  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B89  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001B99  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001BA9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001BB9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001BC9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001BD9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001BE9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001BF9  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C09  fa fa fa fa fa fa fa fa                            ........
00001C11  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C21  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C31  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C41  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C51  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C61  fa fa fa fa fa fa fa fa  fa fa fa fa fa fa fa fa   ........ ........
00001C71  fa fa fa fa fa fa fa fa  fa fa fa fa fa            ........ .....
```

But that's it. No other packet seen.



### Conclusion so far

Cosim has separate TCP streams per interface. The shorter ICMP request and response are seen on both TCP streams. The oversized packet however, is only seen once on each stream, meaning the ICMP request makes it to cosim and is sent back to Junos, but either Junos fails to send it out the wire or the packet never reaches alpine1b. Lets capture the packets in Junos and on the virtual interface within the vQFX container towards alpine2b.



Can't capture in Junos on em3 or em4:

```
root@vqfx1:RE:0% tcpdump -n -i em3 -s 2000
SIOCGIFADDR: em3: Device not configured
```



But capturing on vtapeth1 and vtapeth2 within the Container shows that oversized packets never make it out from the Junos VM. 

```
root@vqfx1:/# tcpdump -n -i vtapeth2 -s 2000
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on vtapeth2, link-type EN10MB (Ethernet), capture size 2000 bytes
11:48:27.291496 IP 192.168.99.1 > 192.168.99.2: ICMP echo request, id 32000, seq 0, length 1494
11:48:27.291592 IP 192.168.99.2 > 192.168.99.1: ICMP echo reply, id 32000, seq 0, length 1494
11:48:28.565685 LLDP, length 271: vqfx1
^C
3 packets captured
3 packets received by filter
0 packets dropped by kernel
root@vqfx1:/# tcpdump -n -i vtapeth1 -s 2000
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on vtapeth1, link-type EN10MB (Ethernet), capture size 2000 bytes
11:48:34.947981 LLDP, length 169: 8a173a6a4996
11:48:35.612218 IP 192.168.99.1 > 192.168.99.2: ICMP echo request, id 32256, seq 0, length 1495
^C
2 packets captured
3 packets received by filter
0 packets dropped by kernel
root@vqfx1:/# tcpdump -n -i vtapeth2 -s 2000
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on vtapeth2, link-type EN10MB (Ethernet), capture size 2000 bytes
^C
0 packets captured
0 packets received by filter
0 packets dropped by kernel
root@vqfx1:/#

```

### Conclusion

Junos does receive large packets from the interface xe-0/0/0 and sends it over one TCP stream to cosim. Cosim forwards the packet correctly to xe-0/0/1 over the other TCP stream, but Junos drops it. 

### Testing traffic to Junos RE

send ping to irb interface 192.168.99.254, then capturing it in Junos on xe-0/0/0:

```
mwiget@shuttle:~/Dropbox/git/container-vqfx$ docker exec -ti testmtu_alpine1a_1 ash
/ #
/ # ping 192.168.99.254 -p af -s 1472 -c 1
PING 192.168.99.254 (192.168.99.254): 1472 data bytes
1480 bytes from 192.168.99.254: seq=0 ttl=64 time=4.170 ms

--- 192.168.99.254 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.170/4.170/4.170 ms
/ # ping 192.168.99.254 -p af -s 1473 -c 1
PING 192.168.99.254 (192.168.99.254): 1473 data bytes
^C
--- 192.168.99.254 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
/ #
```



```
root@vqfx1:RE:0% tcpdump -n -i xe-0/0/0 -s 2000
verbose output suppressed, use <detail> or <extensive> for full protocol decode
Address resolution is OFF.
Listening on xe-0/0/0, capture size 2000 bytes

11:57:30.791688  In IP 192.168.99.1 > 192.168.99.254: ICMP echo request, id 35328, seq 0, length 1480
11:57:30.791747 Out IP 192.168.99.254 > 192.168.99.1: ICMP echo reply, id 35328, seq 0, length 1480
11:57:33.637626  In LLDP, name 8a173a6a4996, length 169
11:57:35.126888 Out LLDP, name vqfx1, length 271
11:57:35.990617  In arp who-has 192.168.99.254 tell 192.168.99.1
11:57:35.990712 Out arp reply 192.168.99.254 is-at 02:05:86:71:25:00
11:57:38.488141  In IP 192.168.99.1 > 192.168.99.254: ICMP echo request, id 35584, seq 0, length 1481
^C
7 packets received by filter
0 packets dropped by kernel
root@vqfx1:RE:0%
```

The shorter packet makes it thru, but the larger one only reaches Junos, but no response is returned.

